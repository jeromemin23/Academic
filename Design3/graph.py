
import numpy as np
import pandas as pd
import matplotlib
matplotlib.use("TkAgg")
from matplotlib import pyplot as plt
from scipy.optimize import curve_fit

#10W

avantT = [9.89E+02,
9.08E+02,
7.85E+02,
6.63E+02,
5.38E+02,
4.66E+02,
4.09E+02,
3.77E+02,
3.52E+02,
3.21E+02,
3.06E+02]


avantPos = [31.53312302,
32.53916168,
33.49216461,
34.28640747,
35.1866684,
36.35149384,
37.49008942,
38.54904556,
39.52867508,
40.77295685,
41.38175583]

milieuT = [7.35E+02,
6.77E+02,
6.35E+02,
5.29E+02,
4.71E+02,
4.27E+02,
3.88E+02,
3.56E+02,
3.36E+02,
3.17E+02,
3.05E+02]

milieuPos = [31.53766251,
32.51725769,
33.49679184,
34.58237457,
35.61471176,
36.67376328,
37.65338516,
38.71234512,
39.66543579,
40.67153549,
41.43927383
]

arriT = [5.77E+02,
5.51E+02,
5.32E+02,
4.77E+02,
4.24E+02,
3.65E+02,
3.30E+02,
3.18E+02,
3.12E+02,
3.05E+02,
3.04E+02
]

arriPos = [31.51563644,
32.46869659,
33.26296997,
34.37490845,
35.46037292,
36.73112869,
37.76361084,
38.69019699,
39.64319992,
40.64923477,
41.33757782
]


avantTprec = [4.10E+02,
3.99E+02,
3.87E+02,
3.76E+02,
3.64E+02,
3.56E+02,
3.47E+02,
3.37E+02,
3.29E+02,
3.22E+02,
3.14E+02,
3.08E+02
]

avantPosprec = [37.43540192,
37.8240509,
38.19150162,
38.5801506,
39.02532959,
39.3645134,
39.74609375,
40.1276741,
40.43859482,
40.73538208,
41.05337143,
41.29362488
]

milieuTprec = [4.11E+02,
4.04E+02,
3.94E+02,
3.84E+02,
3.74E+02,
3.69E+02,
3.55E+02,
3.47E+02,
3.38E+02,
3.30E+02,
3.26E+02,
3.23E+02,
3.19E+02,
3.14E+02,
3.09E+02,
3.05E+02
]

milieuPosprec = [36.9831543,
37.15981674,
37.40007019,
37.64032745,
37.88764954,
38.07843781,
38.62254715,
38.92639923,
39.25144958,
39.63303375,
39.89448929,
40.17007828,
40.45979691,
40.84844589,
41.14523315,
41.40668488
]

arriTprec = [3.52E+02,
3.42E+02,
3.36E+02,
3.30E+02,
3.25E+02,
3.22E+02,
3.20E+02,
3.18E+02,
3.16E+02,
3.14E+02,
3.12E+02,
3.09E+02,
3.07E+02,
3.05E+02,
3.04E+02,
3.04E+02
]

arriPosprec = [37.0396843,
37.34354019,
37.56259537,
37.80285263,
37.99364471,
38.2409668,
38.52361679,
38.85573578,
39.08892441,
39.41397858,
39.75316238,
40.02874756,
40.33966827,
40.5728569,
40.91204071,
41.25828934
]

#1W


arriTPrec1 = [3.06E+02,
3.04E+02,
3.04E+02,
3.03E+02,
3.03E+02,
3.02E+02,
3.02E+02,
3.02E+02,
3.02E+02,
3.02E+02,
3.01E+02,
3.01E+02,
3.01E+02,
3.01E+02,
3.01E+02,
3.01E+02
]

arriPosprec1 = [37.0396843,
37.34354019,
37.56259537,
37.80285263,
37.99364471,
38.2409668,
38.52361679,
38.85573578,
39.08892441,
39.41397858,
39.75316238,
40.02874756,
40.33966827,
40.5728569,
40.91204071,
41.25828934
]


avantTprec1 = [3.19E+02,
3.16E+02,
3.14E+02,
3.12E+02,
3.11E+02,
3.10E+02,
3.10E+02,
3.08E+02,
3.08E+02,
3.06E+02,
3.05E+02,
3.04E+02,
3.04E+02,
3.03E+02,
3.02E+02,
3.02E+02,
3.01E+02
]

avantPosprec1 = [36.02173233,
36.41058731,
36.75278473,
37.05609512,
37.37496185,
37.6860466,
37.95824814,
38.30822372,
38.60375214,
39.11705017,
39.45924377,
39.83254623,
40.1436348,
40.43139267,
40.71136856,
41.04578781,
41.39575958
]


milieuTprec1 = [
3.12E+02,
3.11E+02,
3.10E+02,
3.08E+02,
3.07E+02,
3.06E+02,
3.05E+02,
3.04E+02,
3.03E+02,
3.03E+02,
3.02E+02,
3.02E+02,
3.01E+02,
3.01E+02
]


milieuPosprec1 = [
36.73723221,
37.02498627,
37.40606689,
37.78715134,
38.2693367,
38.6115303,
38.98483658,
39.31925583,
39.71588898,
40.01142502,
40.4236145,
40.6802597,
40.96801758,
41.310215
]



#test

avantPosRad = [31.45693207,
32.02413559,
32.5913353,
32.95128632,
33.33306122,
33.6711998,
34.27112579,
33.99842834,
34.54381561,
34.87104797,
35.13283157,
35.55823517,
36.01636124,
36.28905106,
36.63809967,
36.97623825,
37.33619308,
37.80522537,
38.31789017,
38.88508987,
39.23413467,
39.84496689,
40.58669662,
41.05572891
]

avantTempRad = [3.69E+02,
3.65E+02,
3.61E+02,
3.58E+02,
3.55E+02,
3.45E+02,3.40E+02,
3.36E+02,

3.31E+02,
3.26E+02,
3.24E+02,
3.22E+02,
3.19E+02,
3.17E+02,
3.15E+02,
3.13E+02,
3.11E+02,
3.10E+02,
3.08E+02,
3.07E+02,
3.06E+02,
3.04E+02,
3.03E+02,
3.01E+02
]

#0W Prof

profPos = [41.05561447,
41.24483109,
41.59095764,
41.77556229,
41.987854,
42.23245239,
42.3985939,
42.5693512,
42.71703339,
42.9293251,
43.13238525,
43.34468079,
43.60773849,
43.8477211,
44.09693146,
44.34152985,
44.61381912,
44.85379791,
45.16762543,
45.51836777,
45.90141678,
46.22447205,
46.51522064,
46.80596542,
47.09671402,
47.35977173,
47.7012825,
47.99664688,
48.31970215,
48.58737564,
48.88735199
]
profTemp = [3.30E+02,
3.31E+02,
3.29E+02,
3.28E+02,
3.28E+02,
3.28E+02,
3.29E+02,
3.28E+02,
3.28E+02,
3.27E+02,
3.26E+02,
3.24E+02,
3.23E+02,
3.24E+02,
3.24E+02,
3.25E+02,
3.27E+02,
3.27E+02,
3.22E+02,
3.20E+02,
3.21E+02,
3.22E+02,
3.22E+02,
3.22E+02,
3.22E+02,
3.20E+02,
3.17E+02,
3.15E+02,
3.12E+02,
3.09E+02,
3.06E+02
]
fig, axe = plt.subplots()

#10W vue d'ensemble
# axe.plot([i - avantPos[0] for i in avantPos] , avantT ,label='face avant' )
# axe.plot([i - milieuPos[0] for i in milieuPos] , milieuT,label='centre axiale')
# axe.plot([i - arriPos[0] for i in arriPos] , arriT,label='face arrière')

#10W Précis
# axe.plot([i - avantPos[0] for i in avantPosprec] , avantTprec ,label='face avant' )
# axe.plot([i - milieuPos[0] for i in milieuPosprec] , milieuTprec,label='centre axiale')
# axe.plot([i - arriPos[0] for i in arriPosprec] , arriTprec,label='face arrière')

# 1W précis
# axe.plot([i - avantPos[0] for i in avantPosprec1] , avantTprec1 ,label='face avant' )
# axe.plot([i - milieuPos[0] for i in milieuPosprec1] , milieuTprec1,label='centre axiale')
# axe.plot([i - arriPos[0] for i in arriPosprec1] , arriTPrec1,label='face arrière')

#tests
def exponenial_func(x, a, b, c):
    return a*np.exp(-b*x)+c
popt, pcov = curve_fit(exponenial_func, np.sort([i - profPos[0] for i in profPos]), np.flip(np.sort(profTemp),axis=-1))
print(*popt)
xx = np.linspace(0, 8, 100)
yy = exponenial_func(xx, *popt)
axe.plot([i - profPos[0] for i in profPos] , np.flip(np.sort(profTemp),axis=-1) ,'o',label='données' )
axe.plot(xx, yy,label='fit exponentiel')
# axe.plot([i - arriPos[0] for i in arriPosprec1] , arriTPrec1,label='face arrière')

axe.tick_params(labelsize=12)
axe.legend()
axe.set_xlabel('Distance axiale  [mm]', fontsize='large')
axe.set_ylabel('Température [K]',fontsize='large')
plt.show()
